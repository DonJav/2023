<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="https://getnelson.io/favicon.ico?" type="image/x-icon">

    <meta name="generator" content="Hugo 0.48" />

    <title>Nelson – Cloud-native container deployment</title>

    <link href="https://getnelson.io/css/material.min.css?50f562cfabf3874e76419fb6446706b1" rel="stylesheet">
    
    <link href="https://getnelson.io/css/nelson.css?288f6d09bc4ee782e6108dbe919c6d16" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Barlow:300,600|Open+Sans:300" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
</head>


  <body>
    
    
<nav class="navbar navbar-expand-sm navbar-light bg-blue-5">
  <div class="container">
    <a class="navbar-brand" href="/">
      <img src="/img/nelson-without-background.svg?sanitize=true" width="30" height="30" class="d-inline-block align-top" alt="" />
      &nbsp;
      Nelson
    </a>
    <ul class="navbar-nav mr-auto">
      
      
      <li class="nav-item ">
        <a class="nav-link" href="/introduction/">Introduction</a>
      </li>
      
      <li class="nav-item ">
        <a class="nav-link" href="/getting-started/">Getting Started</a>
      </li>
      
      <li class="nav-item ">
        <a class="nav-link" href="/documentation/">Documentation</a>
      </li>
      
      <li class="nav-item ">
        <a class="nav-link" href="https://github.com/getnelson/nelson">Code</a>
      </li>
      
      <li class="nav-item ">
        <a class="nav-link" href="/api/">API</a>
      </li>
      
    </ul>
  </div>
</nav>
    

    <main role="main">

      <div class="container primary">
        <div class="row">
          <aside class="col-md-3">
  <ol>
    
    
        
            <li class="">
              <a href="/introduction/" class="">Introduction</span></a>
              <ol class="sub-menu">
                  
                      <li class="">
                          <a href="/introduction/use-case.html">Use Cases</a>
                      </li>
                  
                      <li class="">
                          <a href="/introduction/architecture.html">Architecture</a>
                      </li>
                  
                      <li class="">
                          <a href="/introduction/competitors.html">Competitors</a>
                      </li>
                  
              </ol>
            </li>
        
    
        
            <li class="active">
              <a href="/getting-started/index.html" class="">Getting Started</span></a>
              <ol class="sub-menu">
                  
                      <li class="">
                          <a href="/getting-started/install.html">Install</a>
                      </li>
                  
                      <li class="">
                          <a href="/getting-started/first-use.html">First Use</a>
                      </li>
                  
                      <li class="highlight">
                          <a href="/getting-started/deployables.html">Deployables</a>
                      </li>
                  
                      <li class="">
                          <a href="/getting-started/blueprints.html">Blueprints</a>
                      </li>
                  
                      <li class="">
                          <a href="/getting-started/lifecycle.html">Lifecycle</a>
                      </li>
                  
                      <li class="">
                          <a href="/getting-started/routing.html">Routing</a>
                      </li>
                  
                      <li class="">
                          <a href="/getting-started/next.html">Further Reading</a>
                      </li>
                  
              </ol>
            </li>
        
    
        
            <li class="">
              <a href="/documentation/" class="">Documentation</span></a>
              <ol class="sub-menu">
                  
                      <li class="">
                          <a href="/documentation/cli.html">Command Line</a>
                      </li>
                  
                      <li class="">
                          <a href="/documentation/configuration.html">Configuration</a>
                      </li>
                  
                      <li class="">
                          <a href="/documentation/manifest.html">Manifest Settings</a>
                      </li>
                  
                      <li class="">
                          <a href="/documentation/blueprints.html">Blueprint Settings</a>
                      </li>
                  
                      <li class="">
                          <a href="/documentation/operator.html">Operator Guide</a>
                      </li>
                  
                      <li class="">
                          <a href="/documentation/api.html">REST API</a>
                      </li>
                  
                      <li class="">
                          <a href="/documentation/contributing.html">Contributing</a>
                      </li>
                  
                      <li class="">
                          <a href="/documentation/credits.html">Credits</a>
                      </li>
                  
              </ol>
            </li>
        
    
</ol>
</aside>

          <article class="col-md-9">
            <h1>Deployables</h1>

            
            <p>An important differentiator of Nelson is that it does not care what kind of CI system you use. Nelson avoids this coupling directly to a CI platform by signaling the addition of deployments, via <a href="https://developer.github.com/v3/repos/deployments/">GitHub Deployments</a>. This deployment payload serves two purposes: to ensure versioning so that the code and deployment history can be traced through GitHub, and to inform Nelson which units to deploy for a given deployment payload. By comparison, the manifest located in the user’s repository enumerates all the units and plans under said repository&rsquo;s purview - the logical definition - the deployables encoded in a deployment event tell Nelson which units to actually deploy, and the concrete artifacts to use.</p>
            

            

            
            <hr />
            

            

<p>Manifests describe a logical definition (e.g. a unit name) and deployables tie that logical definition to a physical one (e.g. a specific Docker image). This prevents the need to update the manifest every time a version is bumped (frequent in a continuous delivery setting), whilst avoiding the need for a mutable tag like <code>latest</code>. The <a href="https://github.com/getnelson/slipway">Slipway</a> tool can help with both creating a deployable file as well as triggering the actual GitHub Deployment. Slipway is available as a <a href="https://github.com/getnelson/slipway/releases">small statically linked binary</a>, ready to be pulled and used in a CI pipeline.</p>

<h2 id="protocol">Protocol</h2>

<p>The deployable format - what we call NLDP - is a small binary protocol based on <a href="https://developers.google.com/protocol-buffers/">Google Protocol Buffers</a>. This protocol is located within the Nelson code base, but is automatically extracted into <a href="https://github.com/getnelson/api">getnelson/api</a> for ease of client code generation. Consider the following protocol definition:</p>

<pre><code>message Deployable {
  string unit_name = 1;
  oneof version {
    SemanticVersion semver = 2;
  }
  oneof kind {
    Container container = 3;
  }
}
</code></pre>

<p>The <code>unit_name</code> and <code>version</code> is what Nelson enters into its database - therefore the unit name must match a unit name in the repository manifest. Because Nelson is version-aware, the same logical version cannot be deployed twice - the version must be incremented, though not necessarily sequentially, with each new release. At present, Nelson only supports <a href="https://semver.org/">semantic versioning</a>, with scope for supporting other sortable schemes in the future.</p>

<p>The Docker image tag typically matches the semantic version, but it doesn&rsquo;t have to. Note that the provided Docker image is assumed to exist by the time the release (and therefore the deployment) is made, likely built and pushed by an earlier step in the CI pipeline. Nelson does little with the image string other than forward it to the backing scheduler.</p>

          </article>

        </div>
      </div>

    </main>

    
<div class="jumbotron bg-dark">
  <footer class="container">
    <div class="row">
      <div class="col-md-8 offset-md-2">
        <p>
          Built with &hearts; by the Nelson engineering team.
        </p>
        <p>
          Currently v
                    0.16.185
                  
          &middot; <a href="https://github.com/getnelson/nelson">GitHub</a>
          &middot; <a href="https://github.com/getnelson/nelson/issues">Issues</a>
          &middot; <a href="https://www.apache.org/licenses/LICENSE-2.0.html">Apache 2.0</a>
          &middot; <script type="text/javascript" src="/js/contact.js"></script>
        </p>
      </div>
    </div>
  </footer>
</div>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-57263411-7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-57263411-7');
</script>
<script src="/js/material.min.js?02bc972d0cf15fc9db8fc5722363fb57"></script>

<script src="/js/nelson.js?293cf9d1e69611a9d017e28289caf3ea"></script>


  </body>
</html>
